00001AF6 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 28/12/2023 21:24:13

00000000                             1  *-----------------------------------------------------------
00000000                             2  * Title      : PRACTICA FINAL 23-24
00000000                             3  * Written by : Pau Belmonte Clemente & Enrique Grau Artigao
00000000                             4  * Date       : 13/12/2023
00000000                             5  * Description: Click the balls before they explode!
00000000                             6  *-----------------------------------------------------------
00001000                             7              ORG     $1000
00001000                             8              
00001000                             9              INCLUDE "CONST.X68"
00001000                            10  ; ==============================================================================
00001000                            11  ; GAME CONSTANTS
00001000                            12  ; ==============================================================================
00001000                            13  
00001000                            14  ; --- CERCLES RELATED CONSTANTS ------------------------------------------------
00001000                            15  ;RADINIC: 15 RADFINA:
00001000                            16          
00001000  =00000005                 17  RADINIC EQU 5                   ;CIRCLES INICIAL RADIUS
00001000  =00000064                 18  RADFINA EQU 100                  ;CIRCLES FINAL RADIUS
00001000  =00FFFFFF                 19  COLFINA EQU $00FFFFFF           ;CIRCLES FINAL COLOR
00001000  =00000005                 20  CIRCHIT EQU 5                   ;NUMBER OF CIRCLES TO INCREASE GROWTH SPEED
00001000  =000000FF                 21  ROJO    EQU $000000FF
00001000  =00000000                 22  NEGRO   EQU $00000000
00001000                            23  
00001000                            24  ; --- SCORE RELATED CONSTANTS --------------------------------------------------
00001000                            25  
00001000  =00000000                 26  SCOFCOL     EQU     $00000000              ; TEXT BACKGROUND COLOR
00001000  =00000101                 27  SCOLINE1    EQU     $0101                   ; FIRST TEXT LINE COORDINATES
00001000  =00000102                 28  SCOLINE2    EQU     $0102                   ; SECOND TEXT LINE COORDINATES
00001000                            29  
00001000                            30  
00001000                            31  
00001000                            32  ; --- RANDOM VECTORS CONSTANTS --------------------------------------------------
00001000                            33  
00001000                            34  RANDX      
00001000= 0333 0300 004D 0...       35      DC.W      819, 768, 77, 811, 374 
0000100A= 0104 037D 0165 0...       36      DC.W      260, 893, 357, 830, 1008 
00001014= 01A0 0192 02D2 0...       37      DC.W      416, 402, 722, 1050, 272 
0000101E= 03E0 0198 02FA 0...       38      DC.W      992, 408, 762, 368, 467 
00001028= 0239 03BE 0125 0...       39      DC.W      569, 958, 293, 1170, 977 
00001032= 02B4 0395 048A 0...       40      DC.W      692, 917, 1162, 995, 967 
0000103C= 0467 01B3 0179 0...       41      DC.W      1127, 435, 377, 616, 746 
00001046= 022D 0319 0228 0...       42      DC.W      557, 793, 552, 1218, 470 
00001050= 0194 03A0 013C 0...       43      DC.W      404, 928, 316, 1131, 568 
0000105A= 02EE 00F3 0158 0...       44      DC.W      750, 243, 344, 1013, 1132
00001064= 02AB 011E 009C 0...       45      DC.W      683, 286, 156, 766, 427
0000106E= 00D0 00D2 01B8 0...       46      DC.W      208, 210, 440, 392, 762
00001078= 00F5 011A 044C 0...       47      DC.W      245, 282, 1100, 799, 118
00001082= 00C9 0425 016D 0...       48      DC.W      201, 1061, 365, 356, 795
0000108C= 02B9 029F 0379 0...       49      DC.W      697, 671, 889, 318, 1031
00001096= 029F 00BE 0345 0...       50      DC.W      671, 190, 837, 394, 966
000010A0= 03DA 03F0 0177 0...       51      DC.W      986, 1008, 375, 1009, 23
000010AA= 0127 03F5 0361 0...       52      DC.W      295, 1013, 865, 581, 1012
000010B4= 012C 01F0 0488 0...       53      DC.W      300, 496, 1160, 1210, 837
000010BE= 014B 012D 0275 0...       54      DC.W      331, 301, 629, 930, 784
000010C8= 03AA 045F 0067 0...       55      DC.W      938, 1119, 103, 357, 883
000010D2= 021C 0445 0342 0...       56      DC.W      540, 1093, 834, 552, 243
000010DC= 03F8 03CD 014B 0...       57      DC.W      1016, 973, 331, 362, 390
000010E6= 0140 0440 002D 0...       58      DC.W      320, 1088, 45, 391, 1033
000010F0= 03FE 02BA 0014 0...       59      DC.W      1022, 698, 20, 1102, 370
000010FA                            60  
000010FA                            61  RANDY      
000010FA= 0085 0165 00B4 0...       62      DC.W      133, 357, 180, 577, 150 
00001104= 0025 00AF 012D 0...       63      DC.W      37, 175, 301, 279, 150 
0000110E= 01A6 01B5 01FB 0...       64      DC.W      422, 437, 507, 493, 285
00001118= 020D 0122 0016 0...       65      DC.W      525, 290, 22, 521, 517
00001122= 021C 0229 00B6 0...       66      DC.W      540, 553, 182, 356, 346
0000112C= 0065 01E4 0171 0...       67      DC.W      101, 484, 369, 373, 460
00001136= 0143 019D 0128 0...       68      DC.W      323, 413, 296, 410, 51 
00001140= 00B0 01A8 0212 0...       69      DC.W      176, 424, 530, 78, 78 
0000114A= 0185 0197 01B1 0...       70      DC.W      389, 407, 433, 438, 216
00001154= 01C4 0035 01B7 0...       71      DC.W      452, 53, 439, 108, 474 
0000115E= 022C 01CF 0099 0...       72      DC.W      556, 463, 153, 292, 375
00001168= 0232 00AB 01C7 0...       73      DC.W      562, 171, 455, 501, 275
00001172= 0091 010B 0025 0...       74      DC.W      145, 267, 37, 306, 34
0000117C= 0240 005C 0072 0...       75      DC.W      576, 92, 114, 474, 63
00001186= 01E2 0206 0161 0...       76      DC.W      482, 518, 353, 319, 519
00001190= 0127 017D 0201 0...       77      DC.W      295, 381, 513, 179, 340
0000119A= 005E 01C8 022B 0...       78      DC.W      94, 456, 555, 535, 71
000011A4= 0048 0180 0170 0...       79      DC.W      72, 384, 368, 525, 202
000011AE= 0111 0091 0187 0...       80      DC.W      273, 145, 391, 537, 384
000011B8= 01E4 0085 006C 0...       81      DC.W      484, 133, 108, 354, 140
000011C2= 01CD 0200 0130 0...       82      DC.W      461, 512, 304, 391, 225
000011CC= 0111 01CB 011D 0...       83      DC.W      273, 459, 285, 29, 86
000011D6= 01FD 00C9 00DC 0...       84      DC.W      509, 201, 220, 246, 42
000011E0= 0200 010A 013A 0...       85      DC.W      512, 266, 314, 100, 146
000011EA= 0093 0161 01BE 0...       86      DC.W      147, 353, 446, 204, 26 
000011F4                            87      
000011F4                            88      
000011F4                            89  LVL2X
000011F4= 0158 0206 032B 0...       90    DC.W        344, 518, 811, 1261, 42
000011FE= 005A 01BB 0207 0...       91    DC.W        90, 443, 519, 923, 803
00001208= 0331 00E9 04A7 0...       92    DC.W        817, 233, 1191, 688, 1035
00001212= 040D 0254 0208 0...       93    DC.W        1037, 596, 520, 200, 1257
0000121C= 04F5 0379 02C9 0...       94    DC.W        1269, 889, 713, 927, 264
00001226= 04BA 03D6 0165 0...       95    DC.W        1210, 982, 357, 864, 1234
00001230= 0118 03B1 0418 0...       96    DC.W        280, 945, 1048, 1274, 1208
0000123A= 0286 008A 049E 0...       97    DC.W        646, 138, 1182, 990, 797
00001244= 0268 039C 032F 0...       98    DC.W        616, 924, 815, 678, 657
0000124E= 009E 03D5 0109 0...       99    DC.W        158, 981, 265, 322, 844
00001258= 0104 043E 014B 0...      100    DC.W        260, 1086, 331, 1243, 998
00001262= 005B 018C 0191 0...      101    DC.W        91, 396, 401, 1061, 766
0000126C= 0139 006D 0381 0...      102    DC.W        313, 109, 897, 914, 309
00001276= 0276 0479 0251 0...      103    DC.W        630, 1145, 593, 820, 680
00001280= 0062 01FB 02F0 0...      104    DC.W        98, 507, 752, 291, 103
0000128A= 0303 0222 0194 0...      105    DC.W        771, 546, 404, 957, 957
00001294= 0387 0026 01DF 0...      106    DC.W        903, 38, 479, 228, 1045
0000129E= 0062 04E7 0495 0...      107    DC.W        98, 1255, 1173, 301, 212
000012A8= 0367 0078 034A 0...      108    DC.W        871, 120, 842, 863, 194
000012B2= 01E4 00BB 02E7 0...      109    DC.W        484, 187, 743, 818, 403
000012BC= 008B 0099 04C3 0...      110    DC.W        139, 153, 1219, 1219, 1058
000012C6= 00F7 0424 0160 0...      111    DC.W        247, 1060, 352, 517, 1186
000012D0= 030F 0322 0377 0...      112    DC.W        783, 802, 887, 998, 872
000012DA= 0227 040A 021E 0...      113    DC.W        551, 1034, 542, 410, 323
000012E4= 01C1 00E6 02CC 0...      114    DC.W        449, 230, 716, 72, 1248
000012EE                           115    
000012EE                           116    
000012EE                           117  LVL2Y
000012EE= 00A4 005B 0084 0...      118    DC.W        164, 91, 132, 279, 527
000012F8= 0231 0101 010F 0...      119    DC.W        561, 257, 271, 518, 357
00001302= 019B 0199 0113 0...      120    DC.W        411, 409, 275, 24, 189
0000130C= 00E4 00FF 015B 0...      121    DC.W        228, 255, 347, 516, 347
00001316= 009E 013D 010F 0...      122    DC.W        158, 317, 271, 142, 168
00001320= 00C1 01F4 008B 0...      123    DC.W        193, 500, 139, 385, 427
0000132A= 01FC 003A 0019 0...      124    DC.W        508, 58, 25, 487, 46
00001334= 0212 022F 0225 0...      125    DC.W        530, 559, 549, 57, 59
0000133E= 0151 0085 00DB 0...      126    DC.W        337, 133, 219, 193, 335
00001348= 01AC 020F 0171 0...      127    DC.W        428, 527, 369, 478, 576
00001352= 0063 01E3 0118 0...      128    DC.W        99, 483, 280, 22, 471
0000135C= 0135 0170 0155 0...      129    DC.W        309, 368, 341, 226, 448
00001366= 01F3 0146 00AE 0...      130    DC.W        499, 326, 174, 264, 394
00001370= 00EB 0093 00C5 0...      131    DC.W        235, 147, 197, 460, 441
0000137A= 0052 0059 01F1 0...      132    DC.W        82, 89, 497, 195, 55
00001384= 00EE 0221 0214 0...      133    DC.W        238, 545, 532, 466, 285
0000138E= 011A 0119 002F 0...      134    DC.W        282, 281, 47, 93, 480
00001398= 0239 0041 00A7 0...      135    DC.W        569, 65, 167, 191, 561
000013A2= 019D 00F2 01FD 0...      136    DC.W        413, 242, 509, 512, 82
000013AC= 019F 01BB 014C 0...      137    DC.W        415, 443, 332, 439, 259
000013B6= 00B9 0070 014D 0...      138    DC.W        185, 112, 333, 316, 73
000013C0= 0093 0164 00C2 0...      139    DC.W        147, 356, 194, 219, 309
000013CA= 0129 00CC 00E8 0...      140    DC.W        297, 204, 232, 472, 476
000013D4= 022C 00AB 01A9 0...      141    DC.W        556, 171, 425, 575, 312
000013DE= 0129 005A 019B 0...      142    DC.W        297, 90, 411, 502, 353
000013E8                           143  
000013E8                           144  LVL3X
000013E8= 01EF 01A8 04A2 0...      145    DC.W        495, 424, 1186, 464, 157
000013F2= 0374 0017 025F 0...      146    DC.W        884, 23, 607, 1058, 556
000013FC= 024B 03F2 0315 0...      147    DC.W        587, 1010, 789, 1199, 721
00001406= 04BD 03D3 02E1 0...      148    DC.W        1213, 979, 737, 1114, 125
00001410= 004E 02F8 0486 0...      149    DC.W        78, 760, 1158, 1243, 762
0000141A= 036B 00EB 0348 0...      150    DC.W        875, 235, 840, 377, 1089
00001424= 0197 047E 03B0 0...      151    DC.W        407, 1150, 944, 601, 1034
0000142E= 0304 01D9 04FC 0...      152    DC.W        772, 473, 1276, 523, 871
00001438= 048C 02C7 01D7 0...      153    DC.W        1164, 711, 471, 1077, 203
00001442= 00C8 01D0 0492 0...      154    DC.W        200, 464, 1170, 1165, 1052
0000144C= 0210 039D 02DC 0...      155    DC.W        528, 925, 732, 603, 319
00001456= 0318 041D 0220 0...      156    DC.W        792, 1053, 544, 1107, 269
00001460= 01A9 023B 001F 0...      157    DC.W        425, 571, 31, 447, 55
0000146A= 024C 0033 010D 0...      158    DC.W        588, 51, 269, 37, 926
00001474= 012A 0076 013E 0...      159    DC.W        298, 118, 318, 426, 511
0000147E= 038D 04BD 0283 0...      160    DC.W        909, 1213, 643, 542, 571
00001488= 043B 01E4 03A7 0...      161    DC.W        1083, 484, 935, 671, 859
00001492= 02E1 0191 00D2 0...      162    DC.W        737, 401, 210, 959, 678
0000149C= 0248 03B6 027B 0...      163    DC.W        584, 950, 635, 596, 37
000014A6= 0231 01DA 0386 0...      164    DC.W        561, 474, 902, 1011, 606
000014B0= 00A8 0061 02FB 0...      165    DC.W        168, 97, 763, 964, 1056
000014BA= 04B4 048B 01CA 0...      166    DC.W        1204, 1163, 458, 900, 984
000014C4= 010C 0448 00C3 0...      167    DC.W        268, 1096, 195, 400, 162
000014CE= 02D5 0257 0305 0...      168    DC.W        725, 599, 773, 59, 174
000014D8= 016E 0209 0457 0...      169    DC.W        366, 521, 1111, 682, 1279
000014E2                           170  
000014E2                           171  
000014E2                           172  LVL3Y
000014E2= 0206 0239 01F8 0...      173    DC.W        518, 569, 504, 525, 155
000014EC= 019D 00BE 011C 0...      174    DC.W        413, 190, 284, 449, 528
000014F6= 0182 01B4 007F 0...      175    DC.W        386, 436, 127, 66, 466
00001500= 016F 0174 00B7 0...      176    DC.W        367, 372, 183, 254, 339
0000150A= 01E9 0084 019F 0...      177    DC.W        489, 132, 415, 449, 147
00001514= 0136 0078 008B 0...      178    DC.W        310, 120, 139, 260, 144
0000151E= 0074 01C0 0091 0...      179    DC.W        116, 448, 145, 191, 271
00001528= 01E5 009D 01DB 0...      180    DC.W        485, 157, 475, 369, 273
00001532= 01B4 00AC 0025 0...      181    DC.W        436, 172, 37, 309, 341
0000153C= 0086 0047 0136 0...      182    DC.W        134, 71, 310, 247, 499
00001546= 00CC 00A8 011C 0...      183    DC.W        204, 168, 284, 508, 220
00001550= 0199 0142 01F3 0...      184    DC.W        409, 322, 499, 186, 200
0000155A= 0106 01D0 00B4 0...      185    DC.W        262, 464, 180, 528, 324
00001564= 01B6 0045 0024 0...      186    DC.W        438, 69, 36, 425, 562
0000156E= 0088 0019 0219 0...      187    DC.W        136, 25, 537, 239, 312
00001578= 001A 017D 0128 0...      188    DC.W        26, 381, 296, 34, 172
00001582= 0074 011B 002C 0...      189    DC.W        116, 283, 44, 256, 106
0000158C= 0026 00CF 00BE 0...      190    DC.W        38, 207, 190, 246, 322
00001596= 012F 0094 007D 0...      191    DC.W        303, 148, 125, 56, 363
000015A0= 018A 0084 0064 0...      192    DC.W        394, 132, 100, 544, 368
000015AA= 0022 0165 0088 0...      193    DC.W        34, 357, 136, 23, 292
000015B4= 013D 00AF 0089 0...      194    DC.W        317, 175, 137, 459, 107
000015BE= 0147 0097 0180 0...      195    DC.W        327, 151, 384, 163, 481
000015C8= 018D 0177 0137 0...      196    DC.W        397, 375, 311, 124, 371
000015D2= 0141 0235 01CA 0...      197    DC.W        321, 565, 458, 35, 523
000015DC                           198  
000015DC                           199  
000015DC                           200  
000015DC                           201  
000015DC                           202  
000015DC                           203  -------------------- end include --------------------
000015DC                           204              INCLUDE "LIB/DMMCONST.X68"
000015DC                           205  ; =============================================================================
000015DC                           206  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
000015DC                           207  ; =============================================================================
000015DC                           208  
000015DC  =00000040                209  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
000015DC  =00000032                210  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
000015DC  =00000000                211  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
000015DC  =00000000                212  -------------------- end include --------------------
000015DC                           213              INCLUDE "SYSCONST.X68"
000015DC                           214  ; ==============================================================================
000015DC                           215  ; SYSTEM CONSTANTS
000015DC                           216  ; ==============================================================================
000015DC                           217  
000015DC                           218  ; --- SCREEN RELATED CONSTANTS -------------------------------------------------
000015DC                           219  
000015DC  =00000640                220  SCRWIDTH    EQU     1600             ; SCREEN WIDTH
000015DC  =00000320                221  SCRHEIGH    EQU     800             ; SCREEN HEIGHT
000015DC  =0000003C                222  FRAMRATE    EQU     60              ; 20 = 50FPS, 10 = 100FPS
000015DC                           223  
000015DC                           224  
000015DC                           225  
000015DC                           226  
000015DC                           227  
000015DC                           228  
000015DC                           229  
000015DC                           230  -------------------- end include --------------------
000015DC                           231              INCLUDE "CIRCLE.X68"
000015DC                           232  
000015DC                           233  
000015DC                           234  
000015DC                           235  ;==============================================================================
000015DC                           236  ;CIRCLE MANAGMENT  (AGENT)
000015DC                           237  ;CIRCRAD (W)    (A0)        RADIO DE CADA CIRCULO
000015DC                           238  ;CIRCVEC (W)    2(A0)       PUNTERO AL VECTOR DE POSICIONES
000015DC                           239  
000015DC                           240  
000015DC                           241  ;==============================================================================
000015DC                           242  
000015DC                           243  ;------------------------------------------------------------------------------
000015DC                           244  CIRCINIT:
000015DC                           245  ;CIRLCE INITIALIZATION
000015DC                           246  ;INPUT: A0 (POINTER VARIABLES)
000015DC                           247  ;OUTPUT:
000015DC                           248  ;------------------------------------------------------------------------------
000015DC                           249  
000015DC                           250  
000015DC  103C 0050                251          MOVE.B  #80,D0
000015E0  7200                     252          MOVE.L  #NEGRO,D1
000015E2  4E4F                     253          TRAP    #15             ;SET PEN COLOR
000015E4                           254      
000015E4  103C 0051                255          MOVE.B  #81,D0
000015E8  223C 000000FF            256          MOVE.L  #ROJO,D1
000015EE  4E4F                     257          TRAP    #15             ;SET FILL COLOR
000015F0                           258  
000015F0  30BC 0005                259          MOVE.W   #RADINIC,(A0)
000015F4  3179 00001B84 0002       260          MOVE.W  (CIRCVEC),2(A0)
000015FC                           261          
000015FC                           262          
000015FC  4E75                     263          RTS
000015FE                           264      
000015FE                           265  ;------------------------------------------------------------------------------        
000015FE                           266      
000015FE                           267  DRAWCIRC:
000015FE                           268  ;CIRCLE PLOT
000015FE                           269  ;INPUT: A0 (POINTER VARIABLES)
000015FE                           270  ;OUTPUT:
000015FE                           271  ;------------------------------------------------------------------------------
000015FE                           272  
000015FE                           273         
000015FE                           274  ;COLOR SELECTOR
000015FE                           275  
000015FE                           276          *CMPI.W  #RADFINA-50,(A0)
000015FE                           277          *BLT     JUMP1
000015FE  103C 0051                278          MOVE.B  #81,D0
00001602  4281                     279          CLR.L   D1
00001604  1228 0001                280          MOVE.B  1(A0),D1
00001608  0601 0064                281          ADD.B   #100,D1
0000160C                           282          
0000160C  4E4F                     283          TRAP    #15
0000160E                           284  
0000160E                           285  
0000160E                           286          
0000160E                           287          
0000160E                           288  
0000160E                           289  
0000160E                           290  ;BLANCO
0000160E  0C50 0063                291          CMPI.W  #RADFINA-1,(A0)
00001612  6D00 000E                292          BLT     JUMP1
00001616  103C 0051                293          MOVE.B  #81,D0
0000161A  223C 00FFFFFF            294          MOVE.L  #COLFINA,D1
00001620  4E4F                     295          TRAP    #15
00001622                           296  
00001622                           297  ;------------------------------------------------------------------------------          
00001622                           298          
00001622                           299  JUMP1:  
00001622  48E7 FE60                300          MOVEM.L D0-D6/A1-A2,-(A7)
00001626  103C 0058                301          MOVE.B  #88,D0
0000162A  4EB9 00001644            302          JSR     GETCORD
00001630  4E4F                     303          TRAP    #15             ;DRAW CIRCLE
00001632                           304          
00001632                           305          
00001632  103C 0051                306          MOVE.B  #81,D0
00001636  223C 000000FF            307          MOVE.L  #ROJO,D1
0000163C  4E4F                     308          TRAP    #15
0000163E                           309          
0000163E                           310  
0000163E  4CDF 067F                311          MOVEM.L (A7)+,D0-D6/A1-A2
00001642                           312          *CMPI.W  #RADFINA,(A0)
00001642                           313          *BEQ     
00001642                           314          
00001642                           315  BACK:            
00001642                           316  
00001642  4E75                     317          RTS
00001644                           318  SUBLIFE:
00001644                           319          *SUBQ.W  #1,(SCOLIFE)
00001644                           320          *BRA BACK
00001644                           321  
00001644                           322  GETCORD:
00001644                           323  
00001644  45F8 13E8                324          LEA LVL3X,A2
00001648  43F8 14E2                325          LEA LVL3Y,A1
0000164C                           326          
0000164C                           327          ;ADDQ.W   #2,(CIRCVEC)
0000164C  3C28 0002                328          MOVE.W  2(A0),D6
00001650                           329  
00001650                           330      ;LEFT X
00001650  3232 6000                331          MOVE.W  (A2,D6.W),D1
00001654  9250                     332          SUB.W   (A0),D1
00001656                           333      
00001656                           334      ;UPPER Y
00001656  3431 6000                335          MOVE.W  (A1,D6.W),D2
0000165A  9450                     336          SUB.W   (A0),D2
0000165C                           337      
0000165C                           338      ;RIGHT X
0000165C  3632 6000                339          MOVE.W  (A2,D6.W),D3
00001660  D650                     340          ADD.W   (A0),D3
00001662                           341      
00001662                           342      ;LOWER Y
00001662  3831 6000                343          MOVE.W  (A1,D6.W),D4
00001666  D850                     344          ADD.W   (A0),D4
00001668  4E75                     345          RTS
0000166A                           346      
0000166A                           347      
0000166A                           348  CIRCUPD:
0000166A  48E7 C000                349          MOVEM.L D0-D1,-(A7)
0000166E  48E7 3000                350          MOVEM.L D2-D3,-(A7)
00001672                           351          
00001672                           352          ;COMPROVAR SI HA EXPLOTAT
00001672  0C50 0064                353          CMPI.W  #RADFINA,(A0) 
00001676  6E00 0052                354          BGT     EXPLOTE
0000167A                           355          
0000167A                           356          ;COMPROVAR SI S'HA CLICAT
0000167A  3239 00001B8A            357          MOVE.W  MOUSCODX,D1
00001680  0441 1000                358          SUB.W   #RANDX,D1
00001684                           359          
00001684  3439 00001B8C            360          MOVE.W  MOUSCODY,D2
0000168A  0442 10FA                361          SUB.W   #RANDY,D2
0000168E                           362          
0000168E  C3C1                     363          MULS    D1,D1
00001690  C5C2                     364          MULS    D2,D2
00001692                           365          
00001692  D441                     366          ADD.W   D1,D2
00001694                           367          
00001694  C4C2                     368          MULU    D2,D2
00001696  3610                     369          MOVE.W  (A0),D3
00001698  C6C3                     370          MULU    D3,D3
0000169A                           371          
0000169A  B642                     372          CMP.W   D2,D3
0000169C  6E00 0008                373          BGT     ALIVE
000016A0  4EB9 00001948            374          JSR     AGLKILL
000016A6                           375                      
000016A6                           376  ALIVE:        
000016A6  5439 00001B91            377          ADDQ.B  #2,(FRAMCONT)
000016AC  0C39 0005 00001B91       378          CMP.B   #5,(FRAMCONT)
000016B4  6E00 04A0                379          BGT     WINT
000016B8  3039 00001B7C            380          MOVE.W  (CIRCVEL),D0
000016BE  D150                     381          ADD.W   D0,(A0)
000016C0  4239 00001B91            382          CLR.B   (FRAMCONT)
000016C6  6000 000E                383          BRA     FIN
000016CA                           384  EXPLOTE:
000016CA  5339 00001B89            385          SUBQ.B  #1,(SCOLIFE)
000016D0  4EB9 00001948            386          JSR     AGLKILL
000016D6                           387     
000016D6                           388       
000016D6  4CDF 000C                389  FIN     MOVEM.L (A7)+,D2-D3
000016DA  4CDF 0003                390          MOVEM.L (A7)+,D0-D1
000016DE                           391     
000016DE  4E75                     392          RTS
000016E0                           393  
000016E0                           394  DISTX   DS.L    1
000016E4                           395  DISTY   DS.L    1
000016E8                           396  
000016E8                           397  
000016E8                           398  
000016E8                           399  
000016E8                           400  
000016E8                           401  
000016E8                           402  
000016E8                           403  
000016E8                           404  
000016E8                           405  
000016E8                           406  
000016E8                           407  
000016E8                           408  
000016E8                           409  
000016E8                           410  
000016E8                           411  -------------------- end include --------------------
000016E8                           412              INCLUDE "SCORE.X68"
000016E8                           413  ; ==============================================================================
000016E8                           414  ; SCOREBOARD MANAGEMENT
000016E8                           415  ; ==============================================================================
000016E8                           416              
000016E8                           417  ; ------------------------------------------------------------------------------
000016E8                           418  SCOINIT
000016E8                           419  ; INITIALIZE SCOREBOARD
000016E8                           420  ; INPUT    : NONE 
000016E8                           421  ; OUTPUT   : NONE
000016E8                           422  ; MODIFIES : NONE
000016E8                           423  ; ------------------------------------------------------------------------------
000016E8  4239 00001B88            424              CLR.B   (SCONUMB)
000016EE  4239 00001B89            425              CLR.B   (SCOLIFE)
000016F4  4E75                     426              RTS
000016F6                           427              
000016F6                           428  ; ------------------------------------------------------------------------------
000016F6                           429  SCOPLOT
000016F6                           430  ; PLOT THE SCOREBOARD
000016F6                           431  ; INPUT    : NONE 
000016F6                           432  ; OUTPUT   : NONE
000016F6                           433  ; MODIFIES : NONE
000016F6                           434  ; ------------------------------------------------------------------------------
000016F6                           435  
000016F6  48E7 C040                436              MOVEM.L D0-D1/A1,-(A7)
000016FA                           437  
000016FA                           438              ; SET BACKGROUND COLOR
000016FA  103C 0051                439              MOVE.B  #81,D0
000016FE  7200                     440              MOVE.L  #SCOFCOL,D1
00001700  4E4F                     441              TRAP    #15
00001702                           442              
00001702                           443              ; SET FIRST LINE POSITION
00001702  103C 000B                444              MOVE.B  #11,D0
00001706  323C 0101                445              MOVE.W  #SCOLINE1,D1
0000170A                           446              
0000170A  4E4F                     447              TRAP    #15
0000170C                           448  
0000170C                           449              ; PRINT FIRST LINE
0000170C  43F9 00001744            450              LEA     .LIFESCOU,A1
00001712  4281                     451              CLR.L   D1
00001714  1239 00001B89            452              MOVE.B  (SCOLIFE),D1
0000171A  103C 0011                453              MOVE.B  #17,D0
0000171E  4E4F                     454              TRAP    #15
00001720                           455  
00001720                           456              ; SET SECOND LINE POSITION
00001720  103C 000B                457              MOVE.B  #11,D0
00001724  323C 0102                458              MOVE.W  #SCOLINE2,D1
00001728  4E4F                     459              TRAP    #15
0000172A                           460  
0000172A                           461              ; PRINT SECOND LINE
0000172A  43F9 0000174C            462              LEA     .CIRCLCOU,A1
00001730  4281                     463              CLR.L   D1
00001732  1239 00001B88            464              MOVE.B  (SCONUMB),D1
00001738  103C 0011                465              MOVE.B  #17,D0
0000173C  4E4F                     466              TRAP    #15
0000173E                           467              
0000173E  4CDF 0203                468              MOVEM.L (A7)+,D0-D1/A1
00001742                           469              
00001742  4E75                     470              RTS
00001744= 4C 49 46 45 53 20 ...    471  .LIFESCOU   DC.B    'LIFES :',0
0000174C= 43 49 52 43 4C 45 ...    472  .CIRCLCOU   DC.B    'CIRCLES HIT:',0
0000175A                           473              DS.W    0
0000175A                           474  
0000175A                           475  
0000175A                           476  
0000175A                           477  -------------------- end include --------------------
0000175A                           478              INCLUDE "SYSTEM.X68"
0000175A                           479  
0000175A                           480  ;=====================================================================
0000175A                           481  ;SYSTEM INITIALIZATION
0000175A                           482  ;=====================================================================
0000175A                           483  
0000175A                           484  SYSINIT:
0000175A  48A7 C000                485              MOVEM.W  D0-D1,-(A7)
0000175E  48A7 3000                486              MOVEM.W  D2-D3,-(A7)
00001762                           487  
00001762  4EB9 000017F2            488              JSR     SCRINIT                   ; SYSTEM INIT
00001768  21FC 00001838 0080       489              MOVE.L  #BUFFUPD,($80)            ; INSTALLS A ROUTINE IN TRAP #0
00001770  21FC 000017F0 0084       490              MOVE.L  #SNDPLAY,($84)
00001778  21FC 00001852 0064       491              MOVE.L  #SCRUPD, ($64)            ; INSTALLS A TIMED ROUTINE
00001780  4239 00001B91            492              CLR.B   (FRAMCONT)
00001786  33FC 0001 00001B7C       493              MOVE.W   #1,(CIRCVEL)
0000178E  40E7                     494              MOVE.W  SR,-(A7)
00001790  0257 D8FF                495              ANDI.W  #$D8FF,(A7)               ; ENABLE INTS            
00001794                           496  
00001794  4C9F 000C                497              MOVEM.W (A7)+, D2-D3
00001798  4C9F 0003                498              MOVEM.W (A7)+, D0-D1
0000179C                           499              
0000179C  4E73                     500              RTE
0000179E                           501  RANINIT:
0000179E                           502  
0000179E  4279 00001B84            503              CLR.W   (CIRCVEC)
000017A4  4E75                     504              RTS
000017A6                           505  
000017A6                           506  
000017A6                           507  ; -----------------------------------------------------------------------------
000017A6                           508  SNDINIT:
000017A6                           509  ;SOUND SYSTEM INIT
000017A6                           510  ; INPUT    - NONE
000017A6                           511  ; OUTPUT   - NONE
000017A6                           512  ; MODIFIES - NONE
000017A6                           513  ; -----------------------------------------------------------------------------
000017A6  48E7 C060                514          MOVEM.L D0-D1/A1-A2,-(A7)
000017AA  4201                     515          CLR.B   D1
000017AC  45F9 000017E4            516          LEA     .SNDLIST,A2
000017B2  201A                     517  .LOOP   MOVE.L  (A2)+,D0
000017B4  6700 000E                518          BEQ     .DONE
000017B8  2240                     519          MOVE.L  D0,A1
000017BA  103C 0047                520          MOVE.B  #71,D0
000017BE  4E4F                     521          TRAP    #15
000017C0  5201                     522          ADDQ.B  #1,D1
000017C2  60EE                     523          BRA     .LOOP
000017C4  4CDF 0603                524  .DONE   MOVEM.L (A7)+,D0-D1/A1-A2
000017C8  4E75                     525          RTS
000017CA= 53 4E 44 2F 48 49 ...    526  .SNDCLK     DC.B    'SND/HIT.wav',0
000017D6= 53 4E 44 2F 4D 49 ...    527  .SNDMISS    DC.B    'SND/MISS.wav',0
000017E4= 000017CA 000017D6 ...    528  .SNDLIST    DC.L    .SNDCLK,.SNDMISS,0
000017F0                           529  
000017F0                           530  
000017F0                           531  
000017F0                           532  ; -----------------------------------------------------------------------------
000017F0                           533  SNDPLAY:
000017F0                           534  ;SOUND SYSTEM INIT
000017F0                           535  ; INPUT    - NONE
000017F0                           536  ; OUTPUT   - NONE
000017F0                           537  ; MODIFIES - NONE
000017F0                           538  ; -----------------------------------------------------------------------------
000017F0                           539  
000017F0  4E73                     540          RTE
000017F2                           541  
000017F2                           542  
000017F2                           543  ; -----------------------------------------------------------------------------
000017F2                           544  SCRINIT:
000017F2                           545  ; INITIALIZES THE SCREEN, SCREEN-RELATED INTERRUPT AND VARS.
000017F2                           546  ; INPUT    - NONE
000017F2                           547  ; OUTPUT   - NONE
000017F2                           548  ; MODIFIES - NONE
000017F2                           549  ; -----------------------------------------------------------------------------
000017F2                           550                          
000017F2  223C 06400320            551              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1 ; SET RESOLUTION
000017F8  103C 0021                552              MOVE.B  #33,D0
000017FC  4E4F                     553              TRAP    #15
000017FE  7201                     554              MOVE.L  #1,D1                     ; SET WINDOWED MODE
00001800  4E4F                     555              TRAP    #15
00001802                           556              
00001802  323C FF00                557              MOVE.W  #$FF00,D1                 ; CLEAR VISIBLE BUFFER
00001806  103C 000B                558              MOVE.B  #11,D0
0000180A  4E4F                     559              TRAP    #15
0000180C                           560              
0000180C  123C 0011                561              MOVE.B  #17,D1                    ; ENABLE DOUBLE BUFFER
00001810  103C 005C                562              MOVE.B  #92,D0
00001814  4E4F                     563              TRAP    #15
00001816                           564              
00001816  323C FF00                565              MOVE.W  #$FF00,D1                 ; CLEAR HIDDEN BUFFER
0000181A  103C 000B                566              MOVE.B  #11,D0
0000181E  4E4F                     567              TRAP    #15
00001820                           568              
00001820  103C 0020                569              MOVE.B  #32,D0                    ;CREACIÓ DE TIMED INT
00001824  123C 0006                570              MOVE.B  #6,D1
00001828  143C 0081                571              MOVE.B  #$81,D2                   ;8(HABILITAR INT) 1(QUINA INT)
0000182C  7610                     572              MOVE.L  #1000/FRAMRATE,D3         ;FER AQUESTA INT CADA X ms
0000182E  4E4F                     573              TRAP    #15
00001830                           574      
00001830  4239 00001B90            575              CLR.B   (SCRINTCT)                                             
00001836                           576              
00001836                           577   
00001836  4E75                     578              RTS
00001838                           579  
00001838                           580  ; -----------------------------------------------------------------------------
00001838                           581  BUFFUPD:
00001838                           582  ; SWITCHES THE BUFFERS AND CLEARS THE HIDDEN ONE 
00001838                           583  ; INPUT    - NONE
00001838                           584  ; OUTPUT   - NONE
00001838                           585  ; MODIFIES - NONE
00001838                           586  ; -----------------------------------------------------------------------------
00001838  48A7 C000                587              MOVEM.W D0-D1,-(A7)
0000183C                           588              
0000183C                           589              ; SWITCH BUFFERS
0000183C  103C 005E                590              MOVE.B  #94,D0
00001840  4E4F                     591              TRAP    #15
00001842                           592             
00001842                           593              ; CLEAR HIDDEN BUFFER
00001842  103C 000B                594              MOVE.B  #11,D0
00001846  323C FF00                595              MOVE.W  #$FF00,D1
0000184A  4E4F                     596              TRAP    #15  
0000184C                           597              
0000184C  4C9F 0003                598              MOVEM.W (A7)+,D0-D1
00001850  4E73                     599              RTE
00001852                           600  
00001852                           601  ;-----------------------------------------------------------------------------            
00001852                           602  SCRUPD
00001852                           603  ; TIMED INTERRUPT
00001852                           604  ;
00001852                           605  ;
00001852                           606  ;
00001852                           607  ;-----------------------------------------------------------------------------
00001852  5239 00001B90            608              ADDQ.B  #1,(SCRINTCT)
00001858  4E73                     609              RTE
0000185A                           610              
0000185A                           611              
0000185A                           612  ;-----------------------------------------------------------------------------             
0000185A                           613  READMOU
0000185A                           614  ;READ MOUSE VARIABLES
0000185A                           615  ;            
0000185A                           616  ;
0000185A                           617  ;
0000185A                           618  ;----------------------------------------------------------------------------- 
0000185A  48A7 C000                619              MOVEM.W D0-D1, -(A7)
0000185E  48A7 3000                620              MOVEM.W D2-D3, -(A7)
00001862                           621              
00001862  303C 003D                622              MOVE.W  #61,D0          ;LECTURA DEL RATOLÍ
00001866  323C 0000                623              MOVE.W  #0,D1
0000186A  4E4F                     624              TRAP    #15
0000186C                           625              
0000186C  13C0 00001B8E            626              MOVE.B  D0, MOUSCLIC     ;EMMAGATZEMAM SI S'HA CLICAT EL RATOLÍ
00001872  2401                     627              MOVE.L  D1, D2          ;PROCÉS D'EXTRACCIÓ DE LA COORDENADA X
00001874  0282 0000FFFF            628              ANDI.L  #$0000FFFF, D2
0000187A  23C2 00001B8A            629              MOVE.L  D2, MOUSCODX     ;EMMAGATZEMAM LA COORDENADA X
00001880                           630              
00001880  2601                     631              MOVE.L  D1, D3          ;PROCÉS D'EXTRACCIÓ DE LA COORDENADA Y
00001882  0283 FFFF0000            632              ANDI.L  #$FFFF0000, D3
00001888  E08B                     633              LSR.L   #8, D3
0000188A  E08B                     634              LSR.L   #8, D3
0000188C  23C3 00001B8C            635              MOVE.L  D3, MOUSCODY     ;EMMAGATZEMAM LA COORDENADA Y
00001892                           636              
00001892  4C9F 000C                637              MOVEM.W (A7)+, D2-D3            
00001896  4C9F 0003                638              MOVEM.W (A7)+, D0-D1
0000189A  4E75                     639              RTS
0000189C                           640              
0000189C                           641              
0000189C                           642  
0000189C                           643  
0000189C                           644  
0000189C                           645  
0000189C                           646  
0000189C                           647  
0000189C                           648  
0000189C                           649  
0000189C                           650  
0000189C                           651  -------------------- end include --------------------
0000189C                           652              INCLUDE "LIB/DMMCODE.X68"
0000189C                           653  ; =============================================================================
0000189C                           654  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
0000189C                           655  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
0000189C                           656  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
0000189C                           657  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
0000189C                           658  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
0000189C                           659  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
0000189C                           660  ; =============================================================================
0000189C                           661  
0000189C                           662  ; -----------------------------------------------------------------------------
0000189C                           663  DMMINIT
0000189C                           664  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
0000189C                           665  ; INPUT    - NONE
0000189C                           666  ; OUTPUT   - NONE
0000189C                           667  ; MODIFIES - NONE
0000189C                           668  ; -----------------------------------------------------------------------------
0000189C  48E7 8080                669              MOVEM.L D0/A0,-(A7)
000018A0  41F9 00001BC0            670              LEA     DMMDATA,A0
000018A6  303C 0031                671              MOVE.W  #DMMBNUM-1,D0
000018AA  30BC 0000                672  .LOOP       MOVE.W  #DMMSYSID,(A0)
000018AE  D1FC 00000040            673              ADD.L   #DMMBSIZE,A0
000018B4  51C8 FFF4                674              DBRA.W  D0,.LOOP
000018B8  4CDF 0101                675              MOVEM.L (A7)+,D0/A0
000018BC  4E75                     676              RTS
000018BE                           677  
000018BE                           678  ; -----------------------------------------------------------------------------
000018BE                           679  DMMFIRST
000018BE                           680  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
000018BE                           681  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000018BE                           682  ; INPUT    - NONE
000018BE                           683  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000018BE                           684  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000018BE                           685  ; -----------------------------------------------------------------------------
000018BE  41F9 00001BC0            686              LEA     DMMDATA,A0
000018C4  4A58                     687  DMMFRLOP    TST.W   (A0)+
000018C6  6600 0016                688              BNE     DMMFRFND
000018CA  D1FC 0000003E            689              ADD.L   #DMMBSIZE-2,A0
000018D0  B1FC 0000283F            690  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
000018D6  6DEC                     691              BLT     DMMFRLOP
000018D8  207C 00000000            692              MOVE.L  #0,A0
000018DE  4E75                     693  DMMFRFND    RTS
000018E0                           694  
000018E0                           695  ; -----------------------------------------------------------------------------
000018E0                           696  DMMNEXT
000018E0                           697  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
000018E0                           698  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000018E0                           699  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
000018E0                           700  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000018E0                           701  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000018E0                           702  ; -----------------------------------------------------------------------------
000018E0  2F00                     703              MOVE.L  D0,-(A7)
000018E2  2008                     704              MOVE.L  A0,D0
000018E4  C0BC FFFFFFC0            705              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000018EA  0680 00000040            706              ADD.L   #DMMBSIZE,D0
000018F0  2040                     707              MOVE.L  D0,A0
000018F2  201F                     708              MOVE.L  (A7)+,D0
000018F4  60DA                     709              BRA     DMMFRCOM
000018F6                           710  
000018F6                           711  ; -----------------------------------------------------------------------------
000018F6                           712  DMMFRSTO
000018F6                           713  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
000018F6                           714  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
000018F6                           715  ; INPUT    - D0.W : ID TO SEARCH
000018F6                           716  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
000018F6                           717  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000018F6                           718  ; -----------------------------------------------------------------------------
000018F6  41F9 00001BC0            719              LEA     DMMDATA,A0
000018FC  B058                     720  DMMFLOOP    CMP.W   (A0)+,D0
000018FE  6700 0016                721              BEQ     DMMFFND
00001902  D1FC 0000003E            722              ADD.L   #DMMBSIZE-2,A0
00001908  B1FC 0000283F            723  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
0000190E  6DEC                     724              BLT     DMMFLOOP
00001910  207C 00000000            725              MOVE.L  #0,A0
00001916  4E75                     726  DMMFFND     RTS
00001918                           727  
00001918                           728  ; -----------------------------------------------------------------------------
00001918                           729  DMMNEXTO
00001918                           730  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
00001918                           731  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001918                           732  ; INPUT    - D0.W : ID TO SEARCH
00001918                           733  ;            A0   : POINTER WITHIN THE CURRENT SLOT
00001918                           734  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001918                           735  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001918                           736  ; -----------------------------------------------------------------------------
00001918  2F00                     737              MOVE.L  D0,-(A7)
0000191A  2008                     738              MOVE.L  A0,D0
0000191C  C0BC FFFFFFC0            739              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001922  0680 00000040            740              ADD.L   #DMMBSIZE,D0
00001928  2040                     741              MOVE.L  D0,A0
0000192A  201F                     742              MOVE.L  (A7)+,D0
0000192C  60DA                     743              BRA     DMMFCOM
0000192E                           744  
0000192E                           745  ; -----------------------------------------------------------------------------
0000192E                           746  DMMALLOC
0000192E                           747  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
0000192E                           748  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
0000192E                           749  ; INPUT    - D0.W : ID TO ASSIGN
0000192E                           750  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
0000192E                           751  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000192E                           752  ; -----------------------------------------------------------------------------
0000192E  3F00                     753              MOVE.W  D0,-(A7)
00001930  4240                     754              CLR.W   D0
00001932  4EB8 18F6                755              JSR     DMMFRSTO
00001936  301F                     756              MOVE.W  (A7)+,D0
00001938  B1FC 00000000            757              CMP.L   #0,A0
0000193E  6700 0006                758              BEQ     .END
00001942  3140 FFFE                759              MOVE.W  D0,-2(A0)
00001946  4E75                     760  .END        RTS
00001948                           761  
00001948                           762  ; -----------------------------------------------------------------------------
00001948                           763  DMMFREE
00001948                           764  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
00001948                           765  ; SYSTEM (0)
00001948                           766  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
00001948                           767  ; OUTPUT   - NONE
00001948                           768  ; MODIFIES - NONE
00001948                           769  ; -----------------------------------------------------------------------------
00001948  48E7 8080                770              MOVEM.L D0/A0,-(A7)
0000194C  2008                     771              MOVE.L  A0,D0
0000194E  C0BC FFFFFFC0            772              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001954  2040                     773              MOVE.L  D0,A0
00001956  4250                     774              CLR.W   (A0)
00001958  4CDF 0101                775              MOVEM.L (A7)+,D0/A0
0000195C  4E75                     776              RTS
0000195C  4E75                     777  -------------------- end include --------------------
0000195E                           778              INCLUDE "LIB/AGLCODE.X68"
0000195E                           779  ; =============================================================================
0000195E                           780  ; AGENT MANAGEMENT
0000195E                           781  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
0000195E                           782  ; +0 - LONG : UPDATE SUBROUTINE POINTER
0000195E                           783  ; +4 - LONG : PLOT SUBROUTINE POINTER
0000195E                           784  ; +8:END    : DATA (AGENT SPECIFIC)
0000195E                           785  ; =============================================================================
0000195E                           786  
0000195E                           787  ; -----------------------------------------------------------------------------
0000195E                           788  AGLADD
0000195E                           789  ; CREATES A NEW AGENT
0000195E                           790  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
0000195E                           791  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
0000195E                           792  ;            A3 - POINTER TO AGENT PLOT FUNCTION
0000195E                           793  ;            D0 - AGENT TYPE (USED AS OWNED BY DMM)
0000195E                           794  ;            D1 - AGENT INITIALIZATION PARAMETER 1
0000195E                           795  ;            D2 - AGENT INITIALIZATION PARAMETER 2
0000195E                           796  ;            D3 - AGENT INITIALIZATION PARAMETER 3
0000195E                           797  ; OUTPUT   - NONE
0000195E                           798  ; MODIFIES - NONE
0000195E                           799  ; -----------------------------------------------------------------------------
0000195E  2F08                     800              MOVE.L  A0,-(A7)
00001960  4EB8 192E                801              JSR     DMMALLOC
00001964  B1FC 00000000            802              CMP.L   #0,A0
0000196A  6700 0008                803              BEQ     .END
0000196E  20CA                     804              MOVE.L  A2,(A0)+
00001970  20CB                     805              MOVE.L  A3,(A0)+
00001972  4E91                     806              JSR     (A1)
00001974  205F                     807  .END        MOVE.L  (A7)+,A0
00001976  4E75                     808              RTS
00001978                           809  
00001978                           810  ; -----------------------------------------------------------------------------
00001978                           811  AGLUPD
00001978                           812  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001978                           813  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001978                           814  ; INPUT    - NONE
00001978                           815  ; OUTPUT   - NONE
00001978                           816  ; MODIFIES - NONE
00001978                           817  ; -----------------------------------------------------------------------------
00001978  48E7 00C0                818              MOVEM.L A0-A1,-(A7)
0000197C  4EB8 18BE                819              JSR     DMMFIRST
00001980  B1FC 00000000            820  .LOOP       CMP.L   #0,A0
00001986  6700 000E                821              BEQ     .END
0000198A  2250                     822              MOVE.L  (A0),A1
0000198C  5088                     823              ADD.L   #8,A0
0000198E  4E91                     824              JSR     (A1)
00001990  4EB8 18E0                825              JSR     DMMNEXT
00001994  60EA                     826              BRA     .LOOP
00001996  4CDF 0300                827  .END        MOVEM.L (A7)+,A0-A1
0000199A  4E75                     828              RTS
0000199C                           829  
0000199C                           830  ; -----------------------------------------------------------------------------
0000199C                           831  AGLPLOT
0000199C                           832  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000199C                           833  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000199C                           834  ; INPUT    - NONE
0000199C                           835  ; OUTPUT   - NONE
0000199C                           836  ; MODIFIES - NONE
0000199C                           837  ; -----------------------------------------------------------------------------
0000199C  48E7 00C0                838              MOVEM.L A0-A1,-(A7)
000019A0  4EB8 18BE                839              JSR     DMMFIRST
000019A4  B1FC 00000000            840  .LOOP       CMP.L   #0,A0
000019AA  6700 0010                841              BEQ     .END
000019AE  2268 0004                842              MOVE.L  4(A0),A1
000019B2  5088                     843              ADD.L   #8,A0
000019B4  4E91                     844              JSR     (A1)
000019B6  4EB8 18E0                845              JSR     DMMNEXT
000019BA  60E8                     846              BRA     .LOOP
000019BC  4CDF 0300                847  .END        MOVEM.L (A7)+,A0-A1
000019C0  4E75                     848              RTS
000019C2                           849  
000019C2                           850  ; -----------------------------------------------------------------------------
000019C2  =00001948                851  AGLKILL     EQU     DMMFREE
000019C2                           852  ; KILLS THE AGENT BY RELEASING ITS MEMORY
000019C2                           853  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
000019C2                           854  ; OUTPUT   - NONE
000019C2                           855  ; MODIFIES - NONE
000019C2                           856  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
000019C2                           857  ; -----------------------------------------------------------------------------
000019C2                           858  -------------------- end include --------------------
000019C2                           859              INCLUDE "LIB/UTLCODE.X68"
000019C2                           860  ; =============================================================================
000019C2                           861  ; UTILITY CODE
000019C2                           862  ; =============================================================================
000019C2                           863  
000019C2                           864  ; -----------------------------------------------------------------------------
000019C2                           865  UTLINIT
000019C2                           866  ; INITIALIZES UTILITY CODE
000019C2                           867  ; INPUT    - NONE
000019C2                           868  ; OUTPUT   - NONE
000019C2                           869  ; MODIFIES - NONE
000019C2                           870  ; -----------------------------------------------------------------------------
000019C2  48E7 C000                871              MOVEM.L D0-D1,-(A7)
000019C6  103C 0008                872              MOVE.B  #8,D0
000019CA  4E4F                     873              TRAP    #15
000019CC  13C1 00001B94            874              MOVE.B  D1,(UTLRNDIX)
000019D2  4CDF 0003                875              MOVEM.L (A7)+,D0-D1
000019D6  4E75                     876              RTS
000019D8                           877  
000019D8                           878  ; -----------------------------------------------------------------------------
000019D8                           879  UTLRAND
000019D8                           880  ; PROVIDES A PSEUDO-RANDOM BYTE
000019D8                           881  ; INPUT    - NONE
000019D8                           882  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000019D8                           883  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000019D8                           884  ; -----------------------------------------------------------------------------
000019D8  2F08                     885              MOVE.L  A0,-(A7)
000019DA  41F9 000019F6            886              LEA     .RANDVEC,A0
000019E0  4280                     887              CLR.L   D0
000019E2  1039 00001B94            888              MOVE.B  (UTLRNDIX),D0
000019E8  1030 0800                889              MOVE.B  (A0,D0.L),D0
000019EC  5239 00001B94            890              ADDQ.B  #1,(UTLRNDIX)
000019F2  205F                     891              MOVE.L  (A7)+,A0
000019F4  4E75                     892              RTS
000019F6                           893  
000019F6                           894  
000019F6= A2 EE 9A 0C F5 24 ...    895  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000019FE= 2A A3 51 26 E0 AC ...    896              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001A06= 75 51 CA FD 33 EB ...    897              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001A0E= 60 CC E7 B8 9A EB ...    898              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001A16= 1D 76 B5 95 B0 89 ...    899              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001A1E= 39 15 48 C9 6E CA ...    900              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001A26= 43 E7 E2 7C 37 25 ...    901              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001A2E= E9 94 CE E9 E4 52 ...    902              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001A36= 37 6D 9A 84 A2 28 ...    903              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001A3E= 19 E2 C6 77 80 D4 ...    904              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001A46= 0A 5A 32 67 33 C2 ...    905              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001A4E= 59 80 DC 0E 57 FC ...    906              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001A56= 8A AB BC F7 07 4D ...    907              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001A5E= EF D5 77 6E 1E BB ...    908              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001A66= D6 E0 2A 8F BD 28 ...    909              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001A6E= 13 4F 66 EC 0A 64 ...    910              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001A76= 56 52 9A 16 9B 90 ...    911              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001A7E= 06 8A A4 F7 01 DA ...    912              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001A86= F2 E7 77 28 B1 76 ...    913              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001A8E= A4 42 E3 81 B1 67 ...    914              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001A96= BF CE FA 16 BF 38 ...    915              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001A9E= D1 8B 50 0C 5F 49 ...    916              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001AA6= DE 4C 14 A2 40 DC ...    917              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001AAE= B6 9B 0A 38 5D AB ...    918              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001AB6= E2 1B DD 75 15 82 ...    919              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001ABE= 8A 26 51 30 9F 47 ...    920              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001AC6= 1E 8A BB 71 C6 6E ...    921              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001ACE= 9F 47 E5 34 94 27 ...    922              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001AD6= 7D 06 D6 BA 30 0F ...    923              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001ADE= EC 7F 7E 03 CF 2D ...    924              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001AE6= 94 5B 23 F2 8B CD ...    925              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001AEE= 74 33 EC B9 0F D5 ...    926              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001AEE= 74 33 EC B9 0F D5 ...    927  -------------------- end include --------------------
00001AF6                           928              
00001AF6                           929  START:      
00001AF6                           930  ;---- INITIALIZATION ---------------------------------------------------------
00001AF6  007C 0700                931              ORI     #$0700,SR     ;DESACTIVACIÓ DE INTERRUPCIONS I MODE USUARI
00001AFA  4EB8 175A                932              JSR     SYSINIT       ;INICIALITZACIÓ DEL SISTEMA
00001AFE  4EB8 189C                933              JSR     DMMINIT       ;INICIALITZACIÓ DELS AGENTS (CERCLES)
00001B02  4EB8 179E                934              JSR     RANINIT       ;
00001B06  4EB8 16E8                935              JSR     SCOINIT
00001B0A  13FC 0032 00001B89       936              MOVE.B  #50,(SCOLIFE)  ;INICIALITACIÓ DE LES VIDES
00001B12                           937               
00001B12  43F8 15DC                938              LEA CIRCINIT,A1
00001B16  45F8 166A                939              LEA CIRCUPD,A2
00001B1A  47F8 15FE                940              LEA DRAWCIRC,A3
00001B1E  303C 0001                941              MOVE.W  #1,D0
00001B22  4EB8 195E                942              JSR     AGLADD
00001B26  4239 00001B92            943              CLR.B   (COUNTER)
00001B2C                           944              
00001B2C                           945  LOOP:      
00001B2C                           946  ;---- UPDATE -----------------------------------------------------------------
00001B2C                           947  
00001B2C  5239 00001B92            948              ADDQ.B  #1,(COUNTER)  ;AFEGIM 1 AL CONTADOR DE CERCLES
00001B32  0C39 001E 00001B92       949              CMP.B   #30,(COUNTER) ;SI HA ARRIBAT A 30
00001B3A  6600 0012                950              BNE     SALTO         ;NO BOTA 
00001B3E  4239 00001B92            951              CLR.B   (COUNTER)     ;REINICIA EL COMPTADOR
00001B44  5479 00001B84            952              ADDQ.W  #2,(CIRCVEC)  ;PUJA LA VELOCITAT DE CREIXEMENT DELS CERCLES
00001B4A  4EB8 195E                953              JSR     AGLADD        ;AFEGIM NOUS CERCLES
00001B4E                           954  SALTO:
00001B4E                           955  
00001B4E                           956  ;READ INPUT DEVICES
00001B4E                           957  
00001B4E  4EB8 185A                958              JSR     READMOU       ;LECTURA DE RATOLÍ
00001B52                           959      
00001B52                           960  ;UPDATE GAME ELEMENTS
00001B52                           961  
00001B52  4EB8 1978                962              JSR     AGLUPD        ;ACTUALITZAM ELS CERCLES TENINT EN COMPTE 
00001B56                           963                                 
00001B56                           964  ;---- SYNCRONIZATION ---------------------------------------------------------
00001B56                           965  
00001B56  4A39 00001B90            966  WINT        TST.B   (SCRINTCT)    ;BUCLE ON ESPERA FINS QUE ARRIBI LA SENYAL 
00001B5C  67F8                     967              BEQ     WINT          ;DE SINCRONISME I PUGUI CONTINUAR
00001B5E  4239 00001B90            968              CLR.B   (SCRINTCT)
00001B64                           969  
00001B64                           970  ;---- DRAWING ----------------------------------------------------------------
00001B64                           971              
00001B64  4EB8 199C                972              JSR      AGLPLOT      ;DIBUIXA AL BUFFER OCULT
00001B68  4EB8 16F6                973              JSR     SCOPLOT       ;DIBUIXA MARCADOR   
00001B6C  4E40                     974              TRAP     #0           ;INTERCANVIA ELS BUFFERS (OCULT<->VISIBLE)
00001B6E                           975              
00001B6E                           976  ;COMO ESTÁ AHORA EL PROGRAMA ACABA AL LLEGAR LA PELOTA A SU RADIO MÁXIMO,
00001B6E                           977  ;CAMBIAR ESTO POR QUE EL JUGADOR PIERDA UNA VIDA
00001B6E                           978  
00001B6E  0C39 0000 00001B89       979              CMPI.B    #0,(SCOLIFE)  ;SI QUEDAN VIDAS EL JUEGO SIGUE
00001B76  66B4                     980              BNE     LOOP
00001B78                           981  
00001B78  FFFF FFFF                982              SIMHALT             
00001B7C                           983              
00001B7C                           984              INCLUDE "VARS.X68"
00001B7C                           985  ; ==============================================================================
00001B7C                           986  ; GAME VARIABLES
00001B7C                           987  ; ==============================================================================
00001B7C                           988  
00001B7C                           989  ; --- CERCLES RELATED VARIABLES-------------------------------------------------
00001B7C                           990  
00001B7C                           991  CIRCVEL DS.W    1           ;CERCLE GROW SPEED
00001B7E                           992  CIRCPOX DS.W    1           ;CERCLE X COORDINATE
00001B80                           993  CIRCPOY DS.W    1           ;CERCLE Y COORDINATE
00001B82                           994  CIRCCOL DS.W    1           ;CERCLE COLOR
00001B84                           995  ;CIRCPOS DS.W    1           ; 2(A0)
00001B84                           996  ;CIRCRAD DS.W    1           ;CERCLE RADIUS     (A0)
00001B84                           997  CIRCVEC DS.W    1           ;CIRCLE RANDOM VECTOR 
00001B86                           998  CONT    DS.W    1 
00001B88                           999  
00001B88                          1000  
00001B88                          1001  
00001B88                          1002  
00001B88                          1003  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
00001B88                          1004  
00001B88                          1005  SCONUMB DS.B    1           ;NUMBER OF CAPTURED CERCLES
00001B89                          1006  SCOLIFE DS.B    1           ;NUMBER OF LIFES
00001B8A                          1007          DS.W    0
00001B8A                          1008  
00001B8A                          1009  
00001B8A                          1010  
00001B8A                          1011  
00001B8A                          1012  
00001B8A                          1013  
00001B8A                          1014  
00001B8A                          1015  
00001B8A                          1016  
00001B8A                          1017  -------------------- end include --------------------
00001B8A                          1018              INCLUDE "SYSVARS.X68"
00001B8A                          1019  ; ============================================================================
00001B8A                          1020  ; SYSTEM VARIABLES
00001B8A                          1021  ; ============================================================================
00001B8A                          1022  
00001B8A                          1023  ; --- MOUSE RELATED VARIABLES ------------------------------------------------
00001B8A                          1024  
00001B8A                          1025  MOUSCODX     DS.W    1               ;MOUSE X COORDINATE
00001B8C                          1026  MOUSCODY     DS.W    1               ;MOUSE Y COORDINATE
00001B8E                          1027  MOUSCLIC     DS.B    1
00001B90                          1028              DS.W    0
00001B90                          1029  
00001B90                          1030  ; --- FRAME RATE RELATED VARIABLES -------------------------------------------
00001B90                          1031  
00001B90                          1032  SCRINTCT    DS.B    1
00001B91                          1033  FRAMCONT    DS.B    1 
00001B92                          1034  COUNTER     DS.B    1          
00001B94                          1035              DS.W    0
00001B94                          1036  
00001B94                          1037  
00001B94                          1038  
00001B94                          1039  
00001B94                          1040  
00001B94                          1041  
00001B94                          1042  
00001B94                          1043  -------------------- end include --------------------
00001B94                          1044              INCLUDE "LIB/UTLVARS.X68"  
00001B94                          1045  ; =============================================================================
00001B94                          1046  ; UTILITY VARIABLES
00001B94                          1047  ; =============================================================================
00001B94                          1048  
00001B94                          1049  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001B96                          1050              DS.W    0
00001B96                          1051  -------------------- end include --------------------
00001B96                          1052              INCLUDE "LIB/DMMVARS.X68"
00001B96                          1053  ; =============================================================================
00001B96                          1054  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
00001B96                          1055  ; =============================================================================
00001B96                          1056  
00001BC0                          1057              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001BC0                          1058  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002840                          1059              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002840                          1060  -------------------- end include --------------------
00002840                          1061            
00002840                          1062  
00002840                          1063              END     START        

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              195E
AGLADD:END          1974
AGLKILL             1948
AGLPLOT             199C
AGLPLOT:END         19BC
AGLPLOT:LOOP        19A4
AGLUPD              1978
AGLUPD:END          1996
AGLUPD:LOOP         1980
ALIVE               16A6
BACK                1642
BUFFUPD             1838
CIRCCOL             1B82
CIRCHIT             5
CIRCINIT            15DC
CIRCPOX             1B7E
CIRCPOY             1B80
CIRCUPD             166A
CIRCVEC             1B84
CIRCVEL             1B7C
COLFINA             FFFFFF
CONT                1B86
COUNTER             1B92
DISTX               16E0
DISTY               16E4
DMMALLOC            192E
DMMALLOC:END        1946
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1BC0
DMMFCOM             1908
DMMFFND             1916
DMMFIRST            18BE
DMMFLOOP            18FC
DMMFRCOM            18D0
DMMFREE             1948
DMMFRFND            18DE
DMMFRLOP            18C4
DMMFRSTO            18F6
DMMINIT             189C
DMMINIT:LOOP        18AA
DMMNEXT             18E0
DMMNEXTO            1918
DMMSYSID            0
DRAWCIRC            15FE
EXPLOTE             16CA
FIN                 16D6
FRAMCONT            1B91
FRAMRATE            3C
GETCORD             1644
JUMP1               1622
LOOP                1B2C
LVL2X               11F4
LVL2Y               12EE
LVL3X               13E8
LVL3Y               14E2
MOUSCLIC            1B8E
MOUSCODX            1B8A
MOUSCODY            1B8C
NEGRO               0
RADFINA             64
RADINIC             5
RANDX               1000
RANDY               10FA
RANINIT             179E
READMOU             185A
ROJO                FF
SALTO               1B4E
SCOFCOL             0
SCOINIT             16E8
SCOLIFE             1B89
SCOLINE1            101
SCOLINE2            102
SCONUMB             1B88
SCOPLOT             16F6
SCOPLOT:CIRCLCOU    174C
SCOPLOT:LIFESCOU    1744
SCRHEIGH            320
SCRINIT             17F2
SCRINTCT            1B90
SCRUPD              1852
SCRWIDTH            640
SNDINIT             17A6
SNDINIT:DONE        17C4
SNDINIT:LOOP        17B2
SNDINIT:SNDCLK      17CA
SNDINIT:SNDLIST     17E4
SNDINIT:SNDMISS     17D6
SNDPLAY             17F0
START               1AF6
SUBLIFE             1644
SYSINIT             175A
UTLINIT             19C2
UTLRAND             19D8
UTLRAND:RANDVEC     19F6
UTLRNDIX            1B94
WINT                1B56
